---
name: "바이오소닉스 BioViewer"
title: "바이오소닉스 BioViewer"
company: "제이원소프트"
layout: page
tools: ["C#", "WinForms", "PalmSens SDK", "OxyPlot"]
period_start: "2024.05"
description: 센서 데이터 차트 표현 및 분석 관리용 의료 S/W 개발.
---

## 프로젝트 개요
BioViewer는 환자/샘플 측정 데이터를 획득, 검토, 분석하는 의료용 소프트웨어입니다. 측정 장비에서 생성되는 데이터를 안정적으로 수집하고, 사용자가 신뢰할 수 있는 형태로 시각화 및 분석할 수 있도록 지원하는 것을 목표로 했습니다. 의료 데이터의 특성상 데이터 무결성에 중점을 두고 개발했습니다.

![BioViewer screenshot]({{ "/assets/images/projects/bioxonics-bioviewer.png" | relative_url }})

본 프로젝트는 요구사항 정의서, 아키텍처 설계서, 상세 설계서, 단위 검증 및 시스템 테스트 문서를 기반으로 진행되었고, 기능 구현과 검증을 체계적으로 연결하여 품질을 확보했습니다. 결과적으로 장비 연동부터 데이터 분석까지 하나의 흐름으로 통합된 안정적인 분석 환경을 제공할 수 있었습니다.

## 목표 및 배경
의료/바이오 측정 시스템은 데이터의 정확성과 재현성이 곧 품질입니다. 실제 현장에서 사용되는 데이터는 의료 판단과 연결될 수 있기 때문에, 시스템은 다음 목표를 만족해야 했습니다.

- 측정 전 단계에서 오류를 차단하여 잘못된 데이터가 저장되지 않도록 한다.
- 장비 통신 및 데이터 파싱 과정에서 신뢰 가능한 데이터만 처리한다.
- 사용자가 측정 결과를 쉽게 이해하고 검토 가능하도록 시각화한다.
- 신규 장비나 프로토콜 추가 시 유지보수와 확장성이 확보되도록 한다.

이러한 요구사항을 바탕으로, 측정 단계별 검증을 강화하고, 데이터 흐름을 명확히 분리한 아키텍처를 적용했습니다.

## 시스템 구성 및 아키텍처
BioViewer는 다음과 같은 기능 모듈로 구성됩니다.

- App Environment: 공통 설정, 사용자 권한, 환경 값 관리
- PDM Interface: 측정 데이터 저장 및 조회
- Viewer Interface: 결과 조회 및 분석 화면
- GAC Interface: 장비 상태 및 프로토콜 연동
- QC Interface: 품질 관리 프로세스 처리
- Detector Interface: 센서 데이터 수집
- Image Processing Interface: 결과 전처리 및 변환
- Main Controller: 측정 시퀀스 전체 흐름 제어

모듈 간 의존성을 최소화하여 기능 변경 시 영향 범위를 줄였으며, 통신·저장·시각화 기능을 분리하여 테스트와 유지보수 효율을 높였습니다.

## 기술 스택 및 적용 이유
- C# / WinForms: 장비 연동과 빠른 UI 개발을 위한 안정적 환경
- PalmSens SDK: 센서 장비 제어 및 데이터 수집을 위한 공식 SDK 활용
- OxyPlot: 대규모 데이터 시각화에서 성능과 커스터마이징을 확보

특히 의료 장비와의 연동 시 신뢰성이 중요하므로, 검증된 SDK와 안정적인 UI 프레임워크를 우선 선택했습니다.

## 데이터 모델 및 저장 전략
데이터는 측정 메타 정보와 측정 값으로 분리해 관리했습니다. 메타 정보에는 측정 ID, 사용자/샘플 ID, 측정 모드, 채널 정보, 장비 상태 및 시간 정보가 포함됩니다. 측정 값은 시간 축 데이터와 측정 결과 값을 분리해 저장하여 조회 성능을 확보했습니다.

- 측정 ID 기준으로 데이터 무결성 보장
- 저장 시점, 장비 정보, 생성자 정보를 함께 기록
- 조회 시에는 요약 데이터 우선 제공 후 상세 데이터 로딩

이 구조를 통해 대량 데이터에서도 빠른 조회와 안정적인 저장을 유지할 수 있었습니다.

## 주요 기능 상세
### 1) 측정 준비 및 ID 생성
측정 준비 단계는 실제 측정 오류를 방지하기 위한 핵심 구간입니다. 측정 모드와 채널을 선택하고, 샘플 ID와 사용자 정보를 입력하며, 장비 상태를 확인합니다. 이 과정에서 아래 검증 절차를 반드시 통과해야만 측정이 시작됩니다.

- 모드/채널 값의 유효성 검사
- 사용자 입력값 형식 검증 및 누락 방지
- 측정 ID 중복 체크 및 자동 생성 규칙 적용
- 장비 연결 상태, 준비 상태 확인

실수로 잘못된 측정을 진행하지 않도록, 검증 실패 시에는 측정 시작 버튼을 비활성화하고 오류 원인을 즉시 표시했습니다.

### 2) 데이터 획득 및 저장
측정이 시작되면 장비에서 데이터가 실시간으로 전송됩니다. 데이터는 수신 즉시 내부 모델로 정규화되며, 저장 단계에서 무결성 검증을 수행합니다. 이 과정은 다음과 같은 흐름으로 구성됩니다.

- 실시간 데이터 수신 및 파싱
- 수신 데이터의 형식/범위 검증
- 내부 표준 포맷으로 변환
- DB 저장 및 저장 결과 확인

저장 시점과 데이터 소스 정보는 함께 기록하여, 추후 감사나 추적이 가능한 구조로 설계했습니다.

### 3) 데이터 조회 및 분석
사용자는 저장된 데이터를 다양한 조건으로 조회하고, 결과를 분석할 수 있습니다. OxyPlot 기반의 차트 모듈을 통해 데이터 변화 추이를 직관적으로 파악할 수 있게 했으며, 다수의 데이터를 비교하거나 필터링하는 기능을 제공합니다.

- 측정 결과 리스트 및 상세 조회
- 시간 축, 채널별 데이터 비교
- 조건 기반 필터링 및 검색
- 결과 차트 확대/축소 및 캡처

데이터 검토 과정에서도 실수 방지 원칙을 적용하여, 잘못된 데이터 선택을 방지하는 확인 절차를 제공했습니다.

### 4) 장비 통신 및 패킷 파싱
장비 통신은 전체 시스템의 신뢰성을 좌우합니다. 통신 연결 유지, 타임아웃 관리, 오류 발생 시 재시도 정책을 도입하여 데이터 손실을 최소화했습니다. 패킷 파싱 과정에서는 프로토콜 기준에 맞지 않는 데이터는 즉시 폐기하도록 설계했습니다.

- 통신 연결 상태 모니터링
- 타임아웃 및 재연결 정책
- 패킷 파싱 및 데이터 무결성 검증
- 통신 오류 시 로그 기록 및 사용자 알림

### 5) 데이터 내보내기
측정 결과는 외부 보고 및 공유를 위해 내보내기 기능을 제공했습니다. 데이터 무결성 보장을 위해 내보내기 시점의 버전 및 생성자 정보도 함께 기록합니다.

- CSV 등 외부 포맷 변환
- 파일명 자동 규칙 적용
- 내보내기 기록 관리

## 알고리즘 및 처리 흐름
측정 알고리즘은 크게 측정 준비 → 측정 실행 → 저장 → 분석 흐름으로 구성됩니다. 특히 측정 모드와 채널에 따라 데이터 해석 방식이 달라지므로, 모드별 처리 로직을 분리했습니다.

- 측정 준비: 설정 값 검증 및 ID 생성
- 측정 실행: 장비 제어 및 데이터 수집
- 저장 처리: 데이터 정규화 및 저장
- 분석 처리: 결과 계산 및 표시

해당 흐름은 Main Controller에서 제어하며, 오류 발생 시 이전 단계로 복귀하도록 설계하여 잘못된 데이터가 누적되지 않도록 했습니다.

## 데이터 흐름 상세 단계
측정 데이터는 수집 → 검증 → 저장 → 조회 → 분석 → 내보내기의 단계를 거칩니다. 각 단계에서 데이터 구조가 어떻게 변화하는지를 명확히 정의하여, 디버깅과 유지보수 시 혼선을 줄였습니다. 또한 단계별 로그 기록을 통해, 문제 발생 시 어느 단계에서 오류가 발생했는지를 빠르게 확인할 수 있도록 했습니다.

## 성능 및 안정성 고려
실시간 데이터 처리 성능을 확보하기 위해 다음과 같은 최적화를 적용했습니다.

- 대용량 데이터 조회 시 페이징 처리
- UI 스레드와 데이터 처리 스레드 분리
- 차트 렌더링 시 필요 데이터만 선택적 로딩

이를 통해 측정 중 UI 응답성을 유지하면서 안정적인 분석 환경을 제공했습니다.


## 예외 처리 정책
예외 처리 시 가장 중요한 것은 사용자가 무엇을 해야 하는지 명확히 안내하는 것입니다. 오류 메시지는 기술 용어 대신 행동 지침을 포함해 제공했고, 동일 유형의 오류는 동일한 메시지 포맷을 적용했습니다. 또한 치명적인 오류는 즉시 측정을 중단하고, 경미한 오류는 경고 후 계속 진행 가능하도록 단계별 정책을 마련했습니다.

## UI/UX 설계
사용자 경험은 신뢰성을 높이는 중요한 요소입니다. BioViewer의 UI는 다음 기준으로 설계되었습니다.

- 측정 단계(준비/측정/완료)를 명확히 구분
- 측정 결과 리스트와 차트 뷰 분리
- 오류 메시지 즉시 표시 및 재시도 유도
- 이전 측정 설정 자동 불러오기

사용자는 최소한의 클릭으로 필요한 정보를 확인할 수 있도록 UI 흐름을 단순화했습니다.

## 로그 및 추적성
의료 데이터의 경우 추적 가능성이 중요합니다. 따라서 모든 주요 이벤트(측정 시작, 저장 성공, 장비 오류, 내보내기 등)를 로그로 남겼습니다. 로그는 문제 발생 시 원인 분석에 활용되며, 사용자 행동과 데이터 처리 과정을 추적할 수 있도록 구성했습니다. 또한 로그 레벨을 구분하여 운영 환경에서는 핵심 이벤트 위주로 관리하고, 문제 발생 시 상세 로그를 확인할 수 있도록 했습니다.

## 데이터 품질 지표와 검증 로직
측정 데이터 품질을 보장하기 위해 최소/최대 범위 검사, 급격한 변화 감지, 누락 구간 여부 확인 등의 검증 로직을 적용했습니다. 기준을 벗어나는 데이터는 경고 표시 후 저장 여부를 재확인하도록 했고, 분석 시에는 표시 색상으로 구분해 사용자가 즉시 판단할 수 있도록 했습니다. 이 과정은 분석 오류를 줄이고, 결과 신뢰도를 높이는 데 중요한 역할을 했습니다.

## 테스트 시나리오 및 검증
테스트는 단위 검증, 통합 검증, 시스템 테스트 단계로 구분하여 진행했습니다. 대표적인 시나리오는 다음과 같습니다.

- 측정 시작 전 입력 값 오류 시 측정 불가 확인
- 장비 연결 해제 시 재연결 흐름 검증
- 비정상 패킷 수신 시 데이터 저장 차단 확인
- 대량 데이터 조회 시 성능 저하 여부 확인
- 데이터 내보내기 결과 포맷 검증

## Overview
- 기간: 2024.05 ~
- 고객사: B사
- 소속: 제이원소프트
- 역할: 개발 및 유지보수
- 주요 업무: 센서 데이터 시각화/분석 기능 구현
